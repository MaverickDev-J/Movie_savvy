schema: '2.0'
stages:
  preprocess:
    cmd: python rag_system/scripts/preprocess_data.py
    deps:
    - path: rag_system/config/rag_config.yaml
      hash: md5
      md5: 1a58cb2811087127587535bb3352958b
      size: 2392
      isexec: true
    - path: rag_system/data/raw
      hash: md5
      md5: f02866c744a2380601b240d2cd476565.dir
      size: 781847791
      nfiles: 6
    - path: rag_system/scripts/preprocess_data.py
      hash: md5
      md5: 4c1be93f535badf90a02899c96329aa8
      size: 27010
      isexec: true
    outs:
    - path: rag_system/data/processed/metadata.json
      hash: md5
      md5: d9639bb4349369592df81002a0473504
      size: 10998066
    - path: rag_system/data/processed/processed_chunks.jsonl
      hash: md5
      md5: f82cf9f5ac556e9ec67f58791a6f06fe
      size: 1006955949
    - path: rag_system/data/processed/processing_stats.json
      hash: md5
      md5: 34c9b3d2963d7e499740ed070c65d133
      size: 321
  embed:
    cmd: python rag_system/retrieval/embedder.py
    deps:
    - path: rag_system/config/rag_config.yaml
      hash: md5
      md5: 1a58cb2811087127587535bb3352958b
      size: 2392
      isexec: true
    - path: rag_system/data/processed/metadata.json
      hash: md5
      md5: 334ffeedbf7e6228443422082beeac3a
      size: 140503846
    - path: rag_system/data/processed/processed_chunks.jsonl
      hash: md5
      md5: f82cf9f5ac556e9ec67f58791a6f06fe
      size: 1006955949
    - path: rag_system/retrieval/embedder.py
      hash: md5
      md5: 3c97a67a553e01498abbe085ba2ec779
      size: 21380
      isexec: true
    outs:
    - path: rag_system/data/processed/embedding_stats.json
      hash: md5
      md5: 14be52aec1d0f7bea816e0bf4cf108e2
      size: 36
    - path: rag_system/data/processed/embeddings
      hash: md5
      md5: a526c35db20e751ddea4dab481e4c12c.dir
      size: 2581238528
      nfiles: 6
  build_index:
    cmd: python rag_system/scripts/build_index.py
    deps:
    - path: rag_system/config/rag_config.yaml
      hash: md5
      md5: 1a58cb2811087127587535bb3352958b
      size: 2392
      isexec: true
    - path: rag_system/data/processed/embeddings
      hash: md5
      md5: a526c35db20e751ddea4dab481e4c12c.dir
      size: 2581238528
      nfiles: 6
    - path: rag_system/data/processed/metadata.json
      hash: md5
      md5: 4be5fc2d8aee17a974b5f36636e14636
      size: 151266844
    - path: rag_system/data/processed/processed_chunks.jsonl
      hash: md5
      md5: f82cf9f5ac556e9ec67f58791a6f06fe
      size: 1006955949
    - path: rag_system/scripts/build_index.py
      hash: md5
      md5: 296ede7fc8ca8c633c34d1cda5e4488d
      size: 7062
      isexec: true
    outs:
    - path: rag_system/retrieval/index/index.bin
      hash: md5
      md5: f53927024c2a70262c979910c3277b61
      size: 2581237805
    - path: rag_system/retrieval/index/index_metadata.json
      hash: md5
      md5: 8a0fd9c18b7facb6a89d7ab12fea66bf
      size: 74436776
  validate:
    cmd: python rag_system/retrieval/retriever.py --query "best anime like berserk
      recommendation" --top_k 5
    deps:
    - path: rag_system/config/rag_config.yaml
      hash: md5
      md5: 1a58cb2811087127587535bb3352958b
      size: 2392
      isexec: true
    - path: rag_system/data/processed/processed_chunks.jsonl
      hash: md5
      md5: f82cf9f5ac556e9ec67f58791a6f06fe
      size: 1006955949
    - path: rag_system/retrieval/index/index.bin
      hash: md5
      md5: f53927024c2a70262c979910c3277b61
      size: 2581237805
    - path: rag_system/retrieval/index/index_metadata.json
      hash: md5
      md5: 8a0fd9c18b7facb6a89d7ab12fea66bf
      size: 74436776
    - path: rag_system/retrieval/retriever.py
      hash: md5
      md5: 5ad5a11a2751b099a96cc2cb17bc5962
      size: 18412
      isexec: true
